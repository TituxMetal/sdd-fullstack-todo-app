---
import { AuthContainer } from '~/components/containers/AuthContainer'
import Main from '~/layouts/Main.astro'
import { isValidAuthMode } from '~/types/auth.types'

const AUTH_TEXT = {
  login: {
    title: 'Login',
    heading: 'Login to your account'
  },
  signup: {
    title: 'Sign Up',
    heading: 'Create your account'
  }
} as const

const mode = Astro.url.searchParams.get('mode') ?? 'login'
const redirectPath = Astro.url.searchParams.get('redirectPath') ?? undefined
if (mode !== null && !isValidAuthMode(mode)) {
  return Astro.redirect('/auth')
}

const authMode = isValidAuthMode(mode) ? mode : 'login'
const { title, heading } = AUTH_TEXT[authMode]
---

<Main title={title}>
  <section class='container mx-auto px-4 py-8'>
    <h1 class='mb-8 text-center text-4xl font-bold text-zinc-100'>{heading}</h1>
    <AuthContainer client:load mode={authMode} redirectPath={redirectPath} />
  </section>
</Main>
